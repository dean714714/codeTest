<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<script type="text/javascript">
			
			var obj = {
				value: "hello world",
				method: function(){
					//console.log(this.value);
				},
				children: {
					value: "I am child",
					method: function(){
						//console.log(this.value);
					}
				}
			}
			
			//obj.method();输出"hello world"
			//obj.children.method()输出"I am child"
			
			//需求：每次set都返回set的执行环境，也就是具体是哪个对象进行了set操作
			function buildProp(obj){
				for(var prop in obj){
					if(obj.hasOwnProperty(prop)){
						if(typeof prop !== "object"){
							obj["_"+prop] = obj[prop];
							Object.defineProperty(obj,prop,{
								//writable: true, //可写//访问器属性没有writable属性，参见https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty
								enumerable: true,//可枚举（for...in）
								configurable: true,//可配置
								get: function(){
									console.log(prop)
									return obj["_"+prop];
								},
								set: function(value){
									obj["_"+prop] = value;
								}
							})
						}else if(prop instanceof Object&&!(prop instanceof Array)){//如果是对象而不是数组
							buildProp(prop);
						}else{//数组
							
							for(var i=0;i<prop.length;i++){
								
							}
						}
						
					}
					console.log(obj.value)
				}
			}
			buildProp(obj);
			setTimeout(function(){
				//obj.value = "数据被改动了";
				//console.dir(obj);
			},1000)
			
		</script>
	</head>
	<body>
	</body>
</html>
