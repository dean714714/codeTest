<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
	</body>
	<script type="text/javascript">
		
		var canvas = document.createElement('canvas');
		canvas.width = 500;
		canvas.height = 500;
		canvas.style.background = '#000';
		document.body.appendChild(canvas);
		
		var context = canvas.getContext('2d');
		
		var recX=0,recY=0,recW=40,recH=20,shotX=0,shotY=0,shotW=10,shotH=10;
		function Rec(x,y,w,h){
			this.x = x;
			this.y = y;
			this.w = w;
			this.h = h;
			this.draw = function(){
				context.fillStyle = "#fff";
				context.fillRect(this.x,this.y,this.w,this.h);
			};
		}
		
		function Shot(x,y,w,h){
			this.x = x;
			this.y = y;
			this.w = w;
			this.h = h;
			this.shotDot = function(){
				context.fillStyle = "#fff";
				context.fillRect(this.x,this.y,this.w,this.h);
			};
		}
		
		function clear(){
			context.fillStyle = "#000";
			context.fillRect(0,0,canvas.width,canvas.height);
		}
		
		canvas.addEventListener('mousemove',function(e){//产生矩形运动
			recX = e.offsetX;
			recY = e.offsetY;
			shotDotAni(recY);
		});
		
		function shotDotAni(y){//产生小方块运动
			//console.log(y)
			shotX = recX;
			shotY = y;
			requestAnimationFrame(function(){
				shotDotAni(shotY+1);
			});
		};
		
		;(function fresh(){//绘制元素放在这个刷新画布的函数内，来统一刷新频率.属性变化由其他计时器来改变，以此产生动画效果
			clear();
			
			var newshot = new Shot(shotX,shotY,shotW,shotH);
			newshot.shotDot();
			var newRec = new Rec(recX,recY,recW,recH);
			newRec.draw();
			
			requestAnimationFrame(fresh);
		})()
		
		
	</script>
</html>
