<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<script type="text/javascript">
			
			//参见：https://developer.mozilla.org/zh-CN/docs/Web/API/Blob
			
			//blob对象是js中一个存储二进制数据的对象,如图片，文件。它包括两个属性：size和type,前者表示二进制字节数，
			//也就是俗称的文件大小，后者表示文件类型(MIME)，如image/jpeg。且都是只读属性不能更改。
			
			//*****创建方式：
			//var newBlob = new Blob([Array parts],[BlobPropertyBag properties])
			//参数中，前者表示添加到newBlob中的数据数组，可以是任意元素，因为计算机上的任意对象本质上都是二进制数据，
			//可以是DOMString（可以理解为就是字符串）,Blob,ArrayBuffers（缓存在内存中固定长度的二进制数据源，生成后不能更改）
			//后者为一个对象，设置Blob对象的一些属性，主要是type属性，表示数据来源的类型（MIME），如image/jpeg。
			
			//*****获取方式：
			//从blob对象中获取数据的唯一方式是 使用FileReader()。
			//参见：https://developer.mozilla.org/zh-CN/docs/Web/API/FileReader
			//FileReader 对象允许Web应用程序异步读取存储在用户计算机上的文件（或原始数据缓冲区）的内容，
			//使用 File 或 Blob 对象指定要读取的文件或数据。
			
			//DOMString——text
			var blob1 = new Blob(["例1：hello world!"],{type : 'text/plain'});//数据写入blob1对象
			//console.log(blob),输出：Blob { size: 12, type: "text/plain" }
			let reader = new FileReader();
			reader.readAsText(blob1);//读取blob1对象
			reader.onload = function(){//读取成功后（也可以使用onloadend，表示读取结束事件不管是否成功）
				//document.writeln(reader.result);//输出 hello world!
			}
			//DOMString——html
			var blob2 = new Blob(["<ul>例2：<li>1</li><li>2</li></ul>"],{type : 'text/html'});//数据写入blob2对象
			let reader2 = new FileReader();
			reader2.readAsText(blob2);//读取blob2对象
			reader2.onload = function(){//读取成功后（也可以使用onloadend，表示读取结束事件不管是否成功）
				//document.writeln(reader2.result);//页面显示渲染后的结果
			}
			//DOMString——javascript
			var blob3 = new Blob(["<script type='text/javascript'>alert('例3：弹出成功')<\/script>"],{type : 'text/javascript'});//数据写入blob3对象
			let reader3 = new FileReader();
			reader3.readAsText(blob3);//读取blob3对象
			reader3.onload = function(){//读取成功后（也可以使用onloadend，表示读取结束事件不管是否成功）
				//document.writeln(reader3.result);//弹出信息
			}
			//还有更多文件类型参见:http://www.w3school.com.cn/media/media_mimeref.asp
			//https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types
			
			//image
			//网页中最常使用的方式是通过地址链接载入图片，那我们怎么将图片转换成blob对象呢。
			//图片进入web页面有两种方式，一种是通过地址请求加载到页面，比方说传统的img标签，一种是input，'file'的方式,
			//对于前者，浏览器通过url获取到二进制数据并渲染在页面上，我们能知道的只有一个url，而得不到图片本身的数据，所以
			//我们如果能替代浏览器得到这个请求的二进制数据不就可以生成blob对象了，上诉后者就是通过file打开本地资源管理器载入页面的
			//就是二进制数据，而【 File 接口基于Blob，继承 blob功能并将其扩展为支持用户系统上的文件】（MDN https://developer.mozilla.org/zh-CN/docs/Web/API/Blob）
			//file的方式可以
		</script>
	</head>
	<body>
		<input type="file" name="" id="file" value="click" />
	</body>
	<script type="text/javascript">
		//http://www.cnblogs.com/zichi/p/html5-file-api.html
		var $file = document.getElementById('file');
		var readFile = new FileReader();
		$file.onchange = function(){
			readFile.readAsText(document.getElementById('file').files[0]);
			readFile.onload = function(){
				console.log(readFile.result)
			}
		}
		
	</script>
</html>
